<!DOCTYPE html>
<html{{ with site.LanguageCode | default site.Language.Lang }} lang="{{ . }}"{{ end }}>
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  {{- block "meta" . }}
  {{ partialCached "meta.html" . }}
  {{ end -}}

  <script type="text/javascript" src="/vendor/js/uswds/uswds-init.min.js"></script>
  <link rel="preload" href="/vendor/js/uswds/uswds.min.js" as="script">

  {{ partialCached "scss.html" . }}

  {{ range .AlternativeOutputFormats }}
    {{ printf `<link rel="%s" type="%s" href="%s" title="%s" />` .Rel .MediaType.Type .Permalink $.Site.Title | safeHTML }}
  {{ end -}}

  <title>{{ block "title" . }}{{ .Title }}{{ end }}</title>
{{ template "_internal/google_analytics_async.html" . }}

  <script type="text/javascript" defer src="/js/hugo-uswds.min.js"></script>

{{ block "head" . }}
  {{ partialCached "head.html" . }}
{{ end }}

{{- range .Site.Params.custom_css }}
  <link rel="stylesheet" href="{{ . | relURL }}" />
{{- end -}}

{{ range .Page.Params.custom_css }}
  <link rel="stylesheet" href="{{ . | relURL }}" />
{{- end -}}
</head>
<body>

{{- block "top-banner" . -}}
  {{ partialCached "top-banner.html" . }}
{{- end -}}
  
{{- if .Param "usabanner" }}{{ partialCached "components/usa-banner.html" . }}{{ end -}}
{{- with .Param "draftbanner" }}{{ partialCached "components/draft-banner.html" . }}{{ end -}}

{{- block "last-banner" . -}}
  {{ partialCached "last-banner.html" . }}
{{- end }}

{{- block "main" . -}}
<div>baseOf</div>
{{- partialCached "components/usa-header-extended.html" . -}}
{{- partial "site-content.html" . -}}
{{- end -}}

  <p class="font-sans-sm text-center" style="margin: 1.5rem auto">This page was last updated on {{ .Lastmod.Format "January 2, 2006" }}.{{ if .Site.Params.page_repo_path }} <button id="main-improve-page" onclick="window.location.href = '{{ .Site.Params.page_repo_path }}/{{ with .File }}{{ .Path }}{{ end }}';" class="usa-button usa-button--accent-cool">Improve this Page</button>{{ end }}</p>

{{- range .Site.Params.custom_js }}
  <script type="text/javascript" src="{{ . | relURL }}"></script>
{{- end -}}

{{- range .Page.Params.custom_js }}
  <script type="text/javascript" src="{{ . | relURL }}"></script>
{{- end -}}

{{ $usingImageMap := .Page.Store.Get "hasImageMap" }}
{{- if $usingImageMap }}
  <script defer type="text/javascript" src="/vendor/js/image-map-resizer/imageMapResizer.min.js"></script>
{{ end -}}

{{ $usingMermaid := .Page.Store.Get "hasMermaid" }}
{{ if $usingMermaid }}
  <script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/+esm'</script>
{{ end }}

  <script type="text/javascript" src="/vendor/js/uswds/uswds.min.js"></script>

{{ block "foot" . }}
{{ partial "foot.html" . }}
{{ end }}

{{ if or $usingMermaid $usingImageMap }}
<script>
document.addEventListener('DOMContentLoaded', function(){
  $(document).ready(function(e) {
    {{ if $usingMermaid }}
    mermaid.initialize();
    {{ end }}
    {{ if $usingImageMap }}
    $('img[usemap]').imageMapResize();
    {{ end }}
  });
});
</script>
{{ end }}

</body>
</html>
